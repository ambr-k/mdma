<div class="divider">
    Member Details
</div>

<a class="btn btn-link" href="mailto:{{user.email}}">
    {{user.email}}
</a>

{% if let Some(val) = user.consecutive_since_cached %}
<p>Active since {{val}} ({{user.generation_name.as_deref().unwrap_or("Generation N/A")}})</p>
{% endif %}

{% if let Some(val) = user.consecutive_until_cached %}
<p>Active until {{val}}</p>
{% endif %}

<div class="divider">
    Third-Party Accounts
</div>

{% if let Some(wc_users) = webconnex.data %}
{% for wc_user in wc_users %}
<a href="https://manage.webconnex.com/contacts/{{wc_user.id}}" target="_blank" class="btn btn-outline btn-primary">
    GivingFuel ID {{wc_user.id}}
</a>
{% endfor %}
{% endif %}

{% if let Some(discord_enum) = discord %}
<div class="card card-compact card-side bg-neutral h-24 w-full max-w-sm mx-auto my-2">
    {% match discord_enum %}
    {% when DiscordMembership::GuildMember with (discord_member) %}
    <figure class="w-24">
        <img src="{{discord_member.face()}}" />
    </figure>
    <div class="card-body">
        <div class="card-title !mb-0">
            <svg xmlns="http://www.w3.org/2000/svg" width="1.29em" height="1em" viewBox="0 0 256 199">
                <path fill="#5865f2"
                    d="M216.856 16.597A208.5 208.5 0 0 0 164.042 0c-2.275 4.113-4.933 9.645-6.766 14.046q-29.538-4.442-58.533 0c-1.832-4.4-4.55-9.933-6.846-14.046a207.8 207.8 0 0 0-52.855 16.638C5.618 67.147-3.443 116.4 1.087 164.956c22.169 16.555 43.653 26.612 64.775 33.193A161 161 0 0 0 79.735 175.3a136.4 136.4 0 0 1-21.846-10.632a109 109 0 0 0 5.356-4.237c42.122 19.702 87.89 19.702 129.51 0a132 132 0 0 0 5.355 4.237a136 136 0 0 1-21.886 10.653c4.006 8.02 8.638 15.67 13.873 22.848c21.142-6.58 42.646-16.637 64.815-33.213c5.316-56.288-9.08-105.09-38.056-148.36M85.474 135.095c-12.645 0-23.015-11.805-23.015-26.18s10.149-26.2 23.015-26.2s23.236 11.804 23.015 26.2c.02 14.375-10.148 26.18-23.015 26.18m85.051 0c-12.645 0-23.014-11.805-23.014-26.18s10.148-26.2 23.014-26.2c12.867 0 23.236 11.804 23.015 26.2c0 14.375-10.148 26.18-23.015 26.18" />
            </svg>
            {% if let Some(role) = discord_role %}
            <div class="badge badge-outline" style="border-color:#{{role.colour.hex()}}; color:#{{role.colour.hex()}}">
                {{role.name}}
            </div>
            {% else %}
            <div class="badge badge-warning">
                Guild Member, No Role
            </div>
            {% endif %}
        </div>
        <p>
            <b>{{discord_member.display_name()}}</b>
            <br>
            <i>({{discord_member.user.name}})</i>
        </p>
    </div>
    {% when DiscordMembership::GlobalUser with (discord_user) %}
    <figure class="w-1/4">
        <img src="{{discord_user.face()}}" />
    </figure>
    <div class="card-body">
        <h4 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="1.29em" height="1em" viewBox="0 0 256 199">
                <path fill="#5865f2"
                    d="M216.856 16.597A208.5 208.5 0 0 0 164.042 0c-2.275 4.113-4.933 9.645-6.766 14.046q-29.538-4.442-58.533 0c-1.832-4.4-4.55-9.933-6.846-14.046a207.8 207.8 0 0 0-52.855 16.638C5.618 67.147-3.443 116.4 1.087 164.956c22.169 16.555 43.653 26.612 64.775 33.193A161 161 0 0 0 79.735 175.3a136.4 136.4 0 0 1-21.846-10.632a109 109 0 0 0 5.356-4.237c42.122 19.702 87.89 19.702 129.51 0a132 132 0 0 0 5.355 4.237a136 136 0 0 1-21.886 10.653c4.006 8.02 8.638 15.67 13.873 22.848c21.142-6.58 42.646-16.637 64.815-33.213c5.316-56.288-9.08-105.09-38.056-148.36M85.474 135.095c-12.645 0-23.015-11.805-23.015-26.18s10.149-26.2 23.015-26.2s23.236 11.804 23.015 26.2c.02 14.375-10.148 26.18-23.015 26.18m85.051 0c-12.645 0-23.014-11.805-23.014-26.18s10.148-26.2 23.014-26.2c12.867 0 23.236 11.804 23.015 26.2c0 14.375-10.148 26.18-23.015 26.18" />
            </svg>
            <div class="badge badge-error">Not a Guild Member</div>
        </h4>
        <p>
            {{discord_user.name}}
        </p>
    </div>
    {% endmatch %}
</div>
{% endif %}

<div class="divider">
    Actions
</div>

<button class="btn btn-secondary btn-outline" onclick="openModal()" hx-target="#modal-content"
    hx-get="admin/user/{{user.id}}/payment">Add Payment</button>